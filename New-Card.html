<!DOCTYPE html>
<html>

<head>
    <title>Blockchain - T1</title>
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.34/dist/web3.min.js"></script>
    <script type="text/javascript">
        const contract_address = "0x2eAA54EED5a6B3EbfE07EF230Db6605695bA78B6";

        const contract_abi = [
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "DocumentNumber",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "number",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "expiresDate",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "ccv",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "ownerName",
                        "type": "string"
                    }
                ],
                "name": "AddNewCard",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "DocumentNumber",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "Email",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "FullName",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "BirthDate",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "Sex",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "Phone",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "Password",
                        "type": "string"
                    }
                ],
                "name": "RegisterNewUser",
                "outputs": [],
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "DocumentNumber",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "CardNumber",
                        "type": "string"
                    }
                ],
                "name": "GetCardByNumber",
                "outputs": [
                    {
                        "components": [
                            {
                                "internalType": "string",
                                "name": "Number",
                                "type": "string"
                            },
                            {
                                "internalType": "string",
                                "name": "ExpiresDate",
                                "type": "string"
                            },
                            {
                                "internalType": "string",
                                "name": "Ccv",
                                "type": "string"
                            },
                            {
                                "internalType": "string",
                                "name": "OwnerName",
                                "type": "string"
                            }
                        ],
                        "internalType": "struct sharedBuyInformationContract.CreditCard",
                        "name": "",
                        "type": "tuple"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "DocumentNumber",
                        "type": "string"
                    }
                ],
                "name": "GetContractData",
                "outputs": [
                    {
                        "internalType": "string",
                        "name": "",
                        "type": "string"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "DocumentNumber",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "Password",
                        "type": "string"
                    }
                ],
                "name": "LoginWithPlugin",
                "outputs": [
                    {
                        "internalType": "bool",
                        "name": "",
                        "type": "bool"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            }
        ];

        const ethEnabled = () => {
            if (window.ethereum) {
                window.web3 = new Web3(window.ethereum);
                window.ethereum.enable();
                return true;
            }
            return false;
        }

        async function saveCoinbase() {
            window.coinbase = await window.web3.eth.getCoinbase();
        };

        async function loginWithSDP() {
            var documentNumber = document.getElementById("documentNumber").value;
            var password = document.getElementById("password").value;
            try {
                let isRegistered = await window.SimpleStorage.methods
                    .Login(documentNumber, password)
                    .call({ from: window.coinbase });

                console.log(isRegistered);
            }
            catch (err) {
                console.log(err);
                throw err;
            }
        }

        if (!ethEnabled()) {
            alert("Metamask or browser with Ethereum not detected!");
        }
        else {
            window.SimpleStorage = new web3.eth.Contract(contract_abi, contract_address);
            saveCoinbase();
        }

    </script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <!-- <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css"> -->
    <!-- <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css">
</head>

<body>
    <div style="display: flex; flex-direction: column; justify-content: center; height: 100vh;">
        <div class="container">
            <div class="card bg-light">
                <article class="card-body mx-auto" style="max-width: 500px; min-width: 600px;">
                    <div class="accordion" id="accordionExample">
                        <div class="card z-depth-0 bordered">
                            <div class="card-header" id="headingOne">
                                <h5 class="mb-0">
                                    <button class="btn btn-link" type="button" data-toggle="collapse"
                                        data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                        Collapsible Group Item #1
                                    </button>
                                </h5>
                            </div>
                            <div id="collapseOne" class="collapse show" aria-labelledby="headingOne"
                                data-parent="#accordionExample">
                                <div class="card-body">
                                    Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry
                                    richardson ad squid. 3
                                    wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa
                                    nesciunt laborum
                                    eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin
                                    coffee nulla
                                    assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes
                                    anderson cred
                                    nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings
                                    occaecat craft beer
                                    farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them
                                    accusamus
                                    labore sustainable.
                                </div>
                            </div>
                        </div>
                    </div>
                </article>
            </div>
        </div>
    </div>
</body>

</html>